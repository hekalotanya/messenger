(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{12:function(e,t,n){e.exports={app:"App_app__2ziFi",header:"App_header__2L3DO",appHeader:"App_appHeader__3VqWx",table:"App_table__1ESJA",logOutButton:"App_logOutButton__2lxp9",userInfo:"App_userInfo__1K6tZ",profileIcon:"App_profileIcon__2us_q"}},17:function(e,t,n){e.exports={list:"UsersList_list__2AeyC",list__item:"UsersList_list__item__3a1xr",createChatButton:"UsersList_createChatButton__2iGD_"}},28:function(e,t,n){},39:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n.n(r),s=n(22),c=n.n(s),u=(n(28),n(2)),o=n.n(u),i=n(4),p=n(7),l=n(14),j=n(3),b=n(12),f=n.n(b),d=n(13),h=n(15),m="https://hekalot-messenger.herokuapp.com",O=function(){var e=Object(i.a)(o.a.mark((function e(t,n){var r,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=null,e.prev=1,e.next=4,fetch("".concat(m,"/sign-up"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:t,password:n})});case 4:if(!(a=e.sent).ok){e.next=9;break}return e.next=8,a.json();case 8:r=e.sent;case 9:e.next=14;break;case 11:throw e.prev=11,e.t0=e.catch(1),new Error(e.t0);case 14:return e.abrupt("return",r);case 15:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t,n){return e.apply(this,arguments)}}(),x=n(6),v=n.n(x),_=n(1),w=function(e){var t=e.user,n=e.setUser,a=Object(r.useState)({username:"",password:""}),s=Object(p.a)(a,2),c=s[0],u=s[1],b=Object(r.useState)(!1),f=Object(p.a)(b,2),m=f[0],x=f[1],w=function(e){var t=e.target,n=t.name,r=t.value;u((function(e){return Object(h.a)(Object(h.a)({},e),{},Object(d.a)({},n,r))})),x(!1)},g=function(){var e=Object(i.a)(o.a.mark((function e(t){var r,a,s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),r=c.username,a=c.password,s=null,!r.trim()||!a.trim()){e.next=14;break}return e.next=6,O(r,a);case 6:if(s=e.sent,Object.keys(s).length){e.next=11;break}return x(!0),u({username:"",password:""}),e.abrupt("return");case 11:u({username:"",password:""}),localStorage.setItem("token",s.token),n(s);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(_.jsxs)("main",{className:v.a.container,children:[Object(_.jsx)("h1",{children:"Sign up"}),Object(_.jsxs)("form",{className:v.a.form,onSubmit:g,children:[Object(_.jsx)("input",{onChange:w,className:v.a.input,type:"text",name:"username",placeholder:"username",value:c.username}),Object(_.jsx)("input",{onChange:w,className:v.a.input,type:"password",name:"password",placeholder:"password",value:c.password}),m&&Object(_.jsx)("p",{className:v.a.error,children:"Such user already exists"}),Object(_.jsx)("button",{className:v.a.button,type:"submit",disabled:!c.password.trim()||!c.username.trim(),children:"sign up"})]}),Object(_.jsx)(l.b,{className:v.a.link,to:"/sign-in",children:"Have an account?"}),t&&Object(_.jsx)(j.a,{to:"/users"})]})},g=function(){var e=Object(i.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(m,"/chats"),{method:"GET",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:t})});case 2:return n=e.sent,e.abrupt("return",n.json());case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),k=function(e){var t=e.userId,n=Object(r.useState)(!1),a=Object(p.a)(n,2),s=a[0],c=a[1],u=Object(r.useState)([]),l=Object(p.a)(u,2),j=l[0],b=l[1],f=Object(r.useCallback)(Object(i.a)(o.a.mark((function e(){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t){e.next=2;break}return e.abrupt("return");case 2:return c(!0),e.next=5,g(t);case 5:n=e.sent,b(n),c(!1);case 8:case"end":return e.stop()}}),e)}))),[t]);return Object(r.useEffect)((function(){f()}),[f]),t?Object(_.jsx)("ul",{children:!s&&j.map((function(e){return Object(_.jsx)("li",{children:e.id},e.id)}))}):null},S=function(){var e=Object(i.a)(o.a.mark((function e(t,n){var r,a;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=null,e.prev=1,e.next=4,fetch("".concat(m,"/sign-in"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:t,password:n})});case 4:if(!(a=e.sent).ok){e.next=9;break}return e.next=8,a.json();case 8:r=e.sent;case 9:e.next=14;break;case 11:throw e.prev=11,e.t0=e.catch(1),new Error(e.t0);case 14:return e.abrupt("return",r);case 15:case"end":return e.stop()}}),e,null,[[1,11]])})));return function(t,n){return e.apply(this,arguments)}}(),y=function(e){var t=e.user,n=e.setUser,a=Object(r.useState)({username:"",password:""}),s=Object(p.a)(a,2),c=s[0],u=s[1],b=Object(r.useState)(!1),f=Object(p.a)(b,2),m=f[0],O=f[1],x=function(e){var t=e.target,n=t.name,r=t.value;u((function(e){return Object(h.a)(Object(h.a)({},e),{},Object(d.a)({},n,r))})),O(!1)},w=function(){var e=Object(i.a)(o.a.mark((function e(t){var r,a,s;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),r=c.username,a=c.password,s=null,!r.trim()||!a.trim()){e.next=14;break}return e.next=6,S(r,a);case 6:if(s=e.sent,Object.keys(s).length){e.next=11;break}return O(!0),u({username:"",password:""}),e.abrupt("return");case 11:u({username:"",password:""}),localStorage.setItem("token",s.token),n(s);case 14:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(_.jsxs)("main",{className:v.a.container,children:[Object(_.jsx)("h1",{children:"Sign in"}),Object(_.jsxs)("form",{className:v.a.form,onSubmit:w,children:[Object(_.jsx)("input",{onChange:x,className:v.a.input,type:"text",name:"username",placeholder:"username",value:c.username}),Object(_.jsx)("input",{onChange:x,className:v.a.input,type:"password",name:"password",placeholder:"password",value:c.password}),m&&Object(_.jsx)("p",{className:v.a.error,children:"There is no such user"}),Object(_.jsx)("button",{className:v.a.button,type:"submit",disabled:!c.password.trim()||!c.username.trim(),children:"sign in"})]}),Object(_.jsx)(l.b,{className:v.a.link,to:"/sign-up",children:"Create an account"}),t&&Object(_.jsx)(j.a,{to:"/users"})]})},N=function(){var e=Object(i.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(m,"/user/").concat(t));case 2:return n=e.sent,e.abrupt("return",n.json());case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),C=function(){var e=Object(i.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("".concat(m,"/users/").concat(t));case 2:return n=e.sent,e.abrupt("return",n.json());case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),I=n(17),U=n.n(I),A=function(e){var t=e.user,n=Object(r.useState)(!1),a=Object(p.a)(n,2),s=a[0],c=a[1],u=Object(r.useState)([]),l=Object(p.a)(u,2),j=l[0],b=l[1],f=Object(r.useCallback)(Object(i.a)(o.a.mark((function e(){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c(!0),e.next=3,C(t.id);case 3:n=e.sent,b(n),c(!1);case 6:case"end":return e.stop()}}),e)}))),[t]);return Object(r.useEffect)((function(){f()}),[f]),Object(_.jsx)("ul",{className:U.a.list,children:!s&&j.length>0&&j.map((function(e){return Object(_.jsxs)("li",{className:U.a.list__item,children:[e.username,Object(_.jsx)("button",{className:U.a.createChatButton,type:"button",onClick:function(){console.log("create chat")},children:Object(_.jsx)("img",{src:"https://www.svgrepo.com/show/59167/chat.svg",alt:"send message"})})]},e.id)}))})},B=function(){var e=Object(r.useState)(null),t=Object(p.a)(e,2),n=t[0],a=t[1],s=localStorage.getItem("token"),c=Object(r.useCallback)(function(){var e=Object(i.a)(o.a.mark((function e(t){var n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N(t);case 2:n=e.sent,a(n);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),[]);return Object(r.useEffect)((function(){!n&&s&&c(s)})),Object(_.jsxs)(l.a,{children:[Object(_.jsx)("div",{className:f.a.app,children:Object(_.jsxs)("header",{className:f.a.appHeader,children:[Object(_.jsx)("h1",{className:f.a.header,children:"Simple messenger"}),n&&Object(_.jsxs)("div",{className:f.a.userInfo,title:"currently you are logged in as",children:[Object(_.jsx)("img",{src:"https://www.svgrepo.com/show/60372/profile-user.svg",alt:"profile pic",className:f.a.profileIcon}),Object(_.jsx)("span",{children:n.username})]}),n&&Object(_.jsx)("button",{className:f.a.logOutButton,type:"button",onClick:function(){a(null),localStorage.removeItem("token")},children:"Log out"})]})}),Object(_.jsxs)(j.d,{children:[Object(_.jsx)(j.b,{path:"/sign-up",children:Object(_.jsx)(w,{user:n,setUser:a})}),Object(_.jsx)(j.b,{path:"/sign-in",children:Object(_.jsx)(y,{user:n,setUser:a})}),!n&&!s&&Object(_.jsx)(j.a,{to:"/sign-in"}),Object(_.jsx)(j.b,{path:"/users",children:n&&Object(_.jsx)(A,{user:n})}),Object(_.jsx)(j.b,{path:"/chats",children:Object(_.jsx)(k,{userId:null===n||void 0===n?void 0:n.id})})]})]})};c.a.render(Object(_.jsx)(a.a.StrictMode,{children:Object(_.jsx)(B,{})}),document.getElementById("root"))},6:function(e,t,n){e.exports={container:"SignUp_container___8gj8",form:"SignUp_form__37NGc",input:"SignUp_input__1zju_",button:"SignUp_button__f3QJr",error:"SignUp_error__2HfVX",link:"SignUp_link__1BKSZ"}}},[[39,1,2]]]);
//# sourceMappingURL=main.a138da1b.chunk.js.map